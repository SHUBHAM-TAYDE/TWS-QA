<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interview Questions - Question-Bank</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="antialiased">
    <!-- Navbar -->
    <nav class="bg-blue-800 p-4 shadow-lg">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
            <div class="text-2xl font-bold text-white mb-4 md:mb-0">
                <span class="terminal-prompt"></span>Question-Bank
            </div>
            <div class="flex flex-wrap justify-center gap-4">
                <a href="/" class="nav-link">Home</a>
                <a href="/interview-questions" class="nav-link">Interview Questions</a>
                <a href="/jobs" class="nav-link">Jobs</a>
                <a href="https://discord.gg/kGEr9mR5gT" target="_blank" class="nav-link">Join Us</a>
                {% if logged_in %}
                    <a href="/logout" class="nav-link bg-red-600 hover:bg-red-700 text-white">Logout</a>
                {% else %}
                    <a href="/login" class="nav-link bg-blue-700 hover:bg-blue-800 text-white">Login</a>
                {% endif %}
                <!-- Theme Toggle Button -->
                <button id="theme-toggle" class="nav-link" title="Toggle Theme">
                    <i class="fas fa-sun" id="theme-icon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto p-8">

        <section class="py-16 terminal-window">
            <div class="terminal-header">
                <div class="dots">
                    <div class="dot red"></div>
                    <div class="dot yellow"></div>
                    <div class="dot green"></div>
                </div>
                <span>cat categorized_interview_questions.txt</span>
                <div></div>
            </div>
            <h2 class="text-4xl font-bold mb-6 text-center">Categorized <span class="text-blue-600">Interview Questions</span></h2>
            <p class="text-lg text-center mb-8 terminal-prompt">
                Explore DevOps interview questions categorized by type.
            </p>

            <!-- Global Show All Categories Button -->
            <div class="text-center mb-12">
                <button onclick="window.location.href='/interview-questions'" class="btn-terminal bg-gray-600 hover:bg-gray-700">
                    <i class="fas fa-th-large"></i> Show All Categories
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- Card 1: Interview Based Questions -->
                <div id="card-interview-based" class="terminal-window p-6 question-category-card">
                    <div class="terminal-header">
                        <div class="dots">
                            <div class="dot red"></div>
                            <div class="dot yellow"></div>
                            <div class="dot green"></div>
                        </div>
                        <span>interview_based.sh</span>
                        <div></div>
                    </div>
                    <h3 class="text-3xl font-bold mb-4 text-blue-600">Interview Based Questions</h3>
                    <p class="text-md mb-6 terminal-prompt">
                        Standard interview questions covering core DevOps concepts and technologies. Includes multiple-choice questions.
                    </p>
                    <div class="flex flex-wrap justify-center gap-4 mb-6">
                        {% if logged_in %}
                            <a href="/add-question?type=interview_based" class="btn-terminal">
                                <i class="fas fa-plus-circle"></i> Add Question
                            </a>
                        {% else %}
                            <p class="text-amber-500 terminal-prompt">Login to add new questions.</p>
                        {% endif %}
                        <a href="/interview-questions?type_filter=interview-based" class="btn-terminal bg-purple-600 hover:bg-purple-700">
                            <i class="fas fa-eye"></i> View All
                        </a>
                    </div>
                    {# The content below will be controlled by JavaScript #}
                    <div class="space-y-6 question-list-container">
                        {% if interview_based_questions|length == 0 and current_type_filter == 'interview-based' %}
                            <p class="text-center text-red-500 terminal-prompt">DEBUG: No interview-based questions found for this filter. Check your Google Sheet data.</p>
                        {% endif %}
                        {% for question in interview_based_questions %}
                        <div class="bg-blue-100 p-4 rounded-lg border border-blue-200 shadow-sm">
                            <h4 class="text-lg font-semibold mb-2 text-blue-700 terminal-prompt">
                                {{ loop.index }}. {{ question.Question }}
                            </h4>
                            <p class="text-sm text-slate-600 mb-2">
                                <span class="text-amber-500">Type:</span> {{ question.Type | default('General') | replace('_', ' ') | title }} |
                                <span class="text-amber-500">Category:</span> {{ question.Category | default('N/A') }} |
                                <span class="text-amber-500">Difficulty:</span> {{ question.Difficulty | default('N/A') }}
                            </p>
                            {% if question.Type == 'multiple_choice' %}
                                <div class="mt-2 text-slate-700">
                                    <p class="terminal-prompt">A) {{ question['Option A'] | default('N/A') }}</p>
                                    <p class="terminal-prompt">B) {{ question['Option B'] | default('N/A') }}</p>
                                    <p class="terminal-prompt">C) {{ question['Option C'] | default('N/A') }}</p>
                                    <p class="terminal-prompt">D) {{ question['Option D'] | default('N/A') }}</p>
                                </div>
                            {% endif %}
                            <div class="answer-container hidden mt-3 bg-blue-50 p-3 rounded-md border border-blue-200">
                                <p class="terminal-prompt">
                                    <span class="typed-text">
                                        {% if question.Type == 'multiple_choice' %}
                                            Correct Answer: {{ question['Correct Answer'] | default('N/A') | e }}
                                        {% else %}
                                            {{ question.Answer | e }}
                                        {% endif %}
                                    </span>
                                </p>
                            </div>
                            <button class="btn-terminal mt-3 show-answer-btn" data-answer="{% if question.Type == 'multiple_choice' %}Correct Answer: {{ question['Correct Answer'] | default('N/A') | e }}{% else %}{{ question.Answer | e }}{% endif %}">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                            <button class="btn-terminal mt-3 hide-answer-btn hidden">
                                <i class="fas fa-eye-slash"></i> Hide Answer
                            </button>
                        </div>
                        {% else %}
                        <p class="text-center text-amber-500 terminal-prompt">No interview-based questions found yet.</p>
                        {% endfor %}
                    </div>
                </div>

                <!-- Card 2: Scenario Questions -->
                <div id="card-scenario-based" class="terminal-window p-6 question-category-card">
                    <div class="terminal-header">
                        <div class="dots">
                            <div class="dot red"></div>
                            <div class="dot yellow"></div>
                            <div class="dot green"></div>
                        </div>
                        <span>scenario_based.sh</span>
                        <div></div>
                    </div>
                    <h3 class="text-3xl font-bold mb-4 text-blue-600">Scenario Questions</h3>
                    <p class="text-md mb-6 terminal-prompt">
                        Real-world scenarios to test your problem-solving and troubleshooting skills.
                    </p>
                    <div class="flex flex-wrap justify-center gap-4 mb-6">
                        {% if logged_in %}
                            <a href="/add-question?type=scenario_based" class="btn-terminal">
                                <i class="fas fa-plus-circle"></i> Add Question
                            </a>
                        {% else %}
                            <p class="text-amber-500 terminal-prompt">Login to add new questions.</p>
                        {% endif %}
                        <a href="/interview-questions?type_filter=scenario-based" class="btn-terminal bg-purple-600 hover:bg-purple-700">
                            <i class="fas fa-eye"></i> View All
                        </a>
                    </div>
                    {# The content below will be controlled by JavaScript #}
                    <div class="space-y-6 question-list-container">
                        {% if scenario_questions|length == 0 and current_type_filter == 'scenario-based' %}
                            <p class="text-center text-red-500 terminal-prompt">DEBUG: No scenario questions found for this filter. Check your Google Sheet data.</p>
                        {% endif %}
                        {% for question in scenario_questions %}
                        <div class="bg-blue-100 p-4 rounded-lg border border-blue-200 shadow-sm">
                            <h4 class="text-lg font-semibold mb-2 text-blue-700 terminal-prompt">
                                {{ loop.index }}. {{ question.Question }}
                            </h4>
                            <p class="text-sm text-slate-600 mb-2">
                                <span class="text-amber-500">Type:</span> {{ question.Type | default('General') | replace('_', ' ') | title }} |
                                <span class="text-amber-500">Category:</span> {{ question.Category | default('N/A') }} |
                                <span class="text-amber-500">Difficulty:</span> {{ question.Difficulty | default('N/A') }}
                            </p>
                            <div class="answer-container hidden mt-3 bg-blue-50 p-3 rounded-md border border-blue-200">
                                <p class="terminal-prompt">
                                    <span class="typed-text">{{ question.Answer | e }}</span>
                                </p>
                            </div>
                            <button class="btn-terminal mt-3 show-answer-btn" data-answer="{{ question.Answer | e }}">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                            <button class="btn-terminal mt-3 hide-answer-btn hidden">
                                <i class="fas fa-eye-slash"></i> Hide Answer
                            </button>
                        </div>
                        {% else %}
                        <p class="text-center text-amber-500 terminal-prompt">No scenario-based questions found yet.</p>
                        {% endfor %}
                    </div>
                </div>

                <!-- Card 3: Live Interview Questions -->
                <div id="card-live-interview" class="terminal-window p-6 question-category-card">
                    <div class="terminal-header">
                        <div class="dots">
                            <div class="dot red"></div>
                            <div class="dot yellow"></div>
                            <div class="dot green"></div>
                        </div>
                        <span>live_interview.sh</span>
                        <div></div>
                    </div>
                    <h3 class="text-3xl font-bold mb-4 text-blue-600">Live Interview Questions</h3>
                    <p class="text-md mb-6 terminal-prompt">
                        Questions designed for live coding or interactive problem-solving sessions.
                    </p>
                    <div class="flex flex-wrap justify-center gap-4 mb-6">
                        {% if logged_in %}
                            <a href="/add-question?type=live_interview" class="btn-terminal">
                                <i class="fas fa-plus-circle"></i> Add Question
                            </a>
                        {% else %}
                            <p class="text-amber-500 terminal-prompt">Login to add new questions.</p>
                        {% endif %}
                        <a href="/interview-questions?type_filter=live-interview" class="btn-terminal bg-purple-600 hover:bg-purple-700">
                            <i class="fas fa-eye"></i> View All
                        </a>
                    </div>
                    {# The content below will be controlled by JavaScript #}
                    <div class="space-y-6 question-list-container">
                        {% if live_interview_questions|length == 0 and current_type_filter == 'live-interview' %}
                            <p class="text-center text-red-500 terminal-prompt">DEBUG: No live interview questions found for this filter. Check your Google Sheet data.</p>
                        {% endif %}
                        {% for question in live_interview_questions %}
                        <div class="bg-blue-100 p-4 rounded-lg border border-blue-200 shadow-sm">
                            <h4 class="text-lg font-semibold mb-2 text-blue-700 terminal-prompt">
                                {{ loop.index }}. {{ question.Question }}
                            </h4>
                            <p class="text-sm text-slate-600 mb-2">
                                <span class="text-amber-500">Type:</span> {{ question.Type | default('General') | replace('_', ' ') | title }} |
                                <span class="text-amber-500">Category:</span> {{ question.Category | default('N/A') }} |
                                <span class="text-amber-500">Difficulty:</span> {{ question.Difficulty | default('N/A') }}
                            </p>
                            <div class="answer-container hidden mt-3 bg-blue-50 p-3 rounded-md border border-blue-200">
                                <p class="terminal-prompt">
                                    <span class="typed-text">{{ question.Answer | e }}</span>
                                </p>
                            </div>
                            <button class="btn-terminal mt-3 show-answer-btn" data-answer="{{ question.Answer | e }}">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                            <button class="btn-terminal mt-3 hide-answer-btn hidden">
                                <i class="fas fa-eye-slash"></i> Hide Answer
                            </button>
                        </div>
                        {% else %}
                        <p class="text-center text-amber-500 terminal-prompt">No live interview questions found yet.</p>
                        {% endfor %}
                    </div>
                </div>

                <!-- Card 4: Community Driven Questions -->
                <div id="card-community-driven" class="terminal-window p-6 question-category-card">
                    <div class="terminal-header">
                        <div class="dots">
                            <div class="dot red"></div>
                            <div class="dot yellow"></div>
                            <div class="dot green"></div>
                        </div>
                        <span>community_driven.sh</span>
                        <div></div>
                    </div>
                    <h3 class="text-3xl font-bold mb-4 text-blue-600">Community Driven Questions</h3>
                    <p class="text-md mb-6 terminal-prompt">
                        Questions contributed and curated by the TrainWithShubhamCommunity members.
                    </p>
                    <div class="flex flex-wrap justify-center gap-4 mb-6">
                        {% if logged_in %}
                            <a href="/add-question?type=community_driven" class="btn-terminal">
                                <i class="fas fa-plus-circle"></i> Add Question
                            </a>
                        {% else %}
                            <p class="text-amber-500 terminal-prompt">Login to add new questions.</p>
                        {% endif %}
                        <a href="/interview-questions?type_filter=community-driven" class="btn-terminal bg-purple-600 hover:bg-purple-700">
                            <i class="fas fa-eye"></i> View All
                        </a>
                    </div>
                    {# The content below will be controlled by JavaScript #}
                    <div class="space-y-6 question-list-container">
                        {% if community_driven_questions|length == 0 and current_type_filter == 'community-driven' %}
                            <p class="text-center text-red-500 terminal-prompt">DEBUG: No community-driven questions found for this filter. Check your Google Sheet data.</p>
                        {% endif %}
                        {% for question in community_driven_questions %}
                        <div class="bg-blue-100 p-4 rounded-lg border border-blue-200 shadow-sm">
                            <h4 class="text-lg font-semibold mb-2 text-blue-700 terminal-prompt">
                                {{ loop.index }}. {{ question.Question }}
                            </h4>
                            <p class="text-sm text-slate-600 mb-2">
                                <span class="text-amber-500">Type:</span> {{ question.Type | default('General') | replace('_', ' ') | title }} |
                                <span class="text-amber-500">Category:</span> {{ question.Category | default('N/A') }} |
                                <span class="text-amber-500">Difficulty:</span> {{ question.Difficulty | default('N/A') }}
                            </p>
                            <div class="answer-container hidden mt-3 bg-blue-50 p-3 rounded-md border border-blue-200">
                                <p class="terminal-prompt">
                                    <span class="typed-text">{{ question.Answer | e }}</span>
                                </p>
                            </div>
                            <button class="btn-terminal mt-3 show-answer-btn" data-answer="{% if question.Type == 'multiple_choice' %}Correct Answer: {{ question['Correct Answer'] | default('N/A') | e }}{% else %}{{ question.Answer | e }}{% endif %}">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                            <button class="btn-terminal mt-3 hide-answer-btn hidden">
                                <i class="fas fa-eye-slash"></i> Hide Answer
                            </button>
                        </div>
                        {% else %}
                        <p class="text-center text-amber-500 terminal-prompt">No community-driven questions found yet.</p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Add Question Type Modal (Still needed for direct access or if you re-introduce a general add button) -->
    <div id="questionTypeModal" class="modal" style="display: none !important;">
        <div class="modal-content terminal-window">
            <div class="terminal-header">
                <div class="dots">
                    <div class="dot red"></div>
                    <div class="dot yellow"></div>
                    <div class="dot green"></div>
                </div>
                <span>choose_question_type.sh</span>
                <span class="close-button">&times;</span>
            </div>
            <h3 class="text-2xl font-bold mb-6 text-center text-blue-600">Select Question Type</h3>
            <div class="flex flex-col gap-4">
                <button class="btn-terminal modal-type-btn" data-type="scenario_based">
                    <i class="fas fa-lightbulb"></i> Scenario Based Question
                </button>
                <button class="btn-terminal modal-type-btn" data-type="interview_based">
                    <i class="fas fa-user-tie"></i> Interview Based Question
                </button>
                <button class="btn-terminal modal-type-btn" data-type="multiple_choice">
                    <i class="fas fa-list-ol"></i> Multiple Choice Question
                </button>
                <button class="btn-terminal modal-type-btn" data-type="live_interview">
                    <i class="fas fa-microphone"></i> Live Interview Question
                </button>
                <button class="btn-terminal modal-type-btn" data-type="community_driven">
                    <i class="fas fa-users"></i> Community Driven Question
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-blue-800 p-8 text-center text-white text-sm border-t border-blue-900">
        <p class="terminal-prompt">&copy; 2025 TrainWithShubhamCommunity. All rights reserved.</p>
        <p class="terminal-prompt">Built with <i class="fas fa-heart text-red-500"></i> by volunteers.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Theme Toggle Logic
            const themeToggleBtn = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('theme-icon');

            // Function to set the theme
            function setTheme(theme) {
                if (theme === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.body.classList.remove('dark-mode');
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                    localStorage.setItem('theme', 'light');
                }
            }

            // Check for saved theme preference on load
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                setTheme(savedTheme);
            } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                setTheme('dark');
            } else {
                setTheme('light');
            }

            // Toggle theme on button click
            themeToggleBtn.addEventListener('click', () => {
                if (document.body.classList.contains('dark-mode')) {
                    setTheme('light');
                } else {
                    setTheme('dark');
                }
            });

            // Typing effect for answers
            const showAnswerButtons = document.querySelectorAll('.show-answer-btn');
            showAnswerButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const parentDiv = event.target.closest('.bg-blue-100');
                    const answerContainer = parentDiv.querySelector('.answer-container');
                    const hideButton = parentDiv.querySelector('.hide-answer-btn');
                    const answerText = button.dataset.answer;

                    const typedTextSpan = answerContainer.querySelector('.typed-text');
                    typedTextSpan.textContent = '';
                    typedTextSpan.style.width = '0';

                    answerContainer.classList.remove('hidden');
                    button.classList.add('hidden');
                    hideButton.classList.remove('hidden');

                    void typedTextSpan.offsetWidth;
                    typedTextSpan.style.animation = 'none';
                    void typedTextSpan.offsetWidth;
                    typedTextSpan.style.animation = `typing ${answerText.length * 0.05}s steps(${answerText.length}, end) forwards`;
                    typedTextSpan.textContent = answerText;

                    answerContainer.classList.add('typing-container');
                });
            });

            const hideAnswerButtons = document.querySelectorAll('.hide-answer-btn');
            hideAnswerButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const parentDiv = event.target.closest('.bg-blue-100');
                    const answerContainer = parentDiv.querySelector('.answer-container');
                    const showButton = parentDiv.querySelector('.show-answer-btn');

                    answerContainer.classList.add('hidden');
                    showButton.classList.remove('hidden');
                    button.classList.add('hidden');

                    answerContainer.classList.remove('typing-container');
                });
            });

            // Logic to show/hide cards and their content based on type_filter URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const typeFilter = urlParams.get('type_filter');
            const allCards = document.querySelectorAll('.question-category-card');

            console.log(`DEBUG: Initial typeFilter from URL: ${typeFilter}`);

            if (typeFilter && typeFilter !== 'all') {
                allCards.forEach(card => {
                    const cardId = card.id; // e.g., "card-interview-based"
                    const expectedType = 'card-' + typeFilter; // e.g., "card-interview-based"
                    const questionListContainer = card.querySelector('.question-list-container');

                    console.log(`DEBUG: Processing card: ${cardId}, Expected type: ${expectedType}`);

                    if (cardId === expectedType) {
                        card.style.display = 'block'; // Show the selected card
                        if (questionListContainer) {
                            questionListContainer.style.display = 'block'; // Explicitly show questions within this card
                            console.log(`DEBUG: Showing questions for card: ${cardId}. Content:`, questionListContainer.innerHTML.trim().substring(0, 200) + '...');
                        }
                    } else {
                        card.style.display = 'none'; // Hide other cards
                        console.log(`DEBUG: Hiding card: ${cardId}`);
                    }
                });
            } else {
                // If no filter or 'all' filter, ensure all cards are visible but their question lists are hidden
                allCards.forEach(card => {
                    card.style.display = 'block'; // Show all cards
                    const questionListContainer = card.querySelector('.question-list-container');
                    if (questionListContainer) {
                        questionListContainer.style.display = 'none'; // Explicitly hide questions within all cards
                        console.log(`DEBUG: Hiding questions for card: ${card.id} on initial load/reset`);
                    }
                });
            }

            // Modal Logic for Add Question Type Modal (if still present)
            const addQuestionBtn = document.getElementById('addQuestionBtn');
            const questionTypeModal = document.getElementById('questionTypeModal');
            const closeButton = questionTypeModal.querySelector('.close-button');
            const modalTypeButtons = questionTypeModal.querySelectorAll('.modal-type-btn');

            if (addQuestionBtn) { // This button is removed from the main page but kept here for reference
                addQuestionBtn.addEventListener('click', () => {
                    questionTypeModal.style.display = 'flex';
                });
            }

            closeButton.addEventListener('click', () => {
                questionTypeModal.style.display = 'none';
            });

            window.addEventListener('click', (event) => {
                if (event.target === questionTypeModal) {
                    questionTypeModal.style.display = 'none';
                }
            });

            modalTypeButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const type = button.dataset.type;
                    window.location.href = `/add-question?type=${type}`;
                });
            });
        });
    </script>
</body>
</html>

